#!/bin/bash

# Check if ImageMagick is installed
if ! command -v convert &> /dev/null; then
    echo "ImageMagick is not installed. Please install it to continue."
    exit 1
fi

# Set the source and destination directories relative to this script
src_dir="lab04_raw_files"
dst_dir="thumbnails"

# Create the destination directory if it doesn't exist
mkdir -p "$dst_dir"

# Loop through JPG, PNG, and PDF files to create thumbnails
for file in "$src_dir"/*.{jpg,png,pdf}; do
    [ -e "$file" ] || continue  # Skip if no files found
    base=$(basename "$file")
    filename="${base%.*}"
    extension="${base##*.}"

    # Define the thumbnail filename
    thumbnail="${dst_dir}/${filename}_thumb.png"

    # Create a thumbnail for the file
    # For PDFs, this will create a thumbnail of the first page
    # For images, this will create a thumbnail of the image itself
    convert -geometry 300 "${file}[0]" "$thumbnail"  # '[0]' is harmless for img but needed for pdf
    echo "Created thumbnail at $thumbnail"
done
